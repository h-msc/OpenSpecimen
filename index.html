<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Typeface Specimen | Open Source Edition</title>
<script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>
<style>
:root {
--bg: #fdfdfc;
--text: #111;
--accent: #0066ff;
--border: #e0e0e0;
--sidebar-bg: #f8f8f8;
--glass-bg: rgba(255, 255, 255, 0.75);
--glass-border: rgba(255, 255, 255, 0.5);
}
body {
margin: 0;
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
background: var(--bg);
color: var(--text);
-webkit-font-smoothing: antialiased;
overflow-x: hidden;
}

section { padding: 60px 5%; border-bottom: 1px solid var(--border); position: relative; }
h3 { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.1em; color: #888; margin-bottom: 30px; }
.hero h1 {
font-size: clamp(3rem, 15vw, 10rem);
margin: 0;
line-height: 0.85;
letter-spacing: -0.03em;
}

.metadata-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
gap: 20px;
margin-top: 40px;
border-top: 1px solid var(--border);
padding-top: 30px;
}

.meta-item label { display: block; font-size: 0.6rem; text-transform: uppercase; font-weight: 800; color: #aaa; margin-bottom: 4px; }
.meta-item span { font-size: 0.85rem; font-weight: 500; }

/* --- Interactive Tester Sidebar --- */
.tester-container { display: flex; gap: 40px; margin-top: 20px; flex-direction: row; }
#typeTester {
flex: 1; min-height: 300px; border: none; padding: 0;
font-size: 48px; outline: none; background: transparent;
line-height: 1.1; resize: vertical; width: 100%;
}

.sidebar {
width: 300px;
max-width: 100%;
padding: 25px;
background: var(--sidebar-bg);
border-radius: 16px; /* FIXED: Corrected from 166px to 16px */
position: sticky;
top: 20px;
align-self: flex-start;
z-index: 10;
box-sizing: border-box;
}

.control-group { margin-bottom: 25px; }
.control-group label { display: block; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; margin-bottom: 10px; color: #777; }
.val { float: right; color: #000; font-family: monospace; font-weight: bold; }

input[type="range"] {
-webkit-appearance: none;
-moz-appearance: none;
appearance: none; 
width: 100%;
background: transparent;
height: 30px;
}
input[type="range"]::-webkit-slider-runnable-track { width: 100%; height: 2px; background: #ddd; }
input[type="range"]::-webkit-slider-thumb {
-webkit-appearance: none;
appearance: none;
height: 20px; width: 20px; border-radius: 50%;
background: #000; cursor: pointer; margin-top: -9px; border: 2px solid var(--sidebar-bg);
}

.reset-btn {
width: 100%; padding: 12px; background: #eee; border: none; border-radius: 8px;
font-size: 0.7rem; font-weight: 700; text-transform: uppercase; cursor: pointer; margin-top: 10px;
}

/* --- Glyphs Section --- */
.glyph-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
border-top: 1px solid var(--border);
border-left: 1px solid var(--border);
background: white;
overflow: visible;
}

.glyph-item {
aspect-ratio: 1/1;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
border-right: 1px solid var(--border);
border-bottom: 1px solid var(--border);
cursor: pointer;
background: white;
transition: transform 0.4s cubic-bezier(0.2, 1, 0.2, 1), background 0.3s ease, box-shadow 0.3s ease;
position: relative;
z-index: 1;
-webkit-backface-visibility: hidden;
backface-visibility: hidden;
transform: translateZ(0);
will-change: transform;
}

@media (hover: hover) {
.glyph-item:hover:not(.active) {
z-index: 5;
transform: scale(1.2) translateZ(0);
background: #fff;
box-shadow: 0 10px 25px rgba(0,0,0,0.08);
}
}

.glyph-item.active {
z-index: 100;
transform: scale(2.5) translateZ(0);
background: var(--glass-bg);
backdrop-filter: blur(15px) saturate(180%);
-webkit-backdrop-filter: blur(15px) saturate(180%);
border: 1px solid var(--glass-border);
box-shadow: 0 30px 60px rgba(0,0,0,0.12), inset 0 0 0 1px rgba(255,255,255,0.6);
border-radius: 12px;
}

.char {
font-size: 1.8rem;
line-height: 1;
pointer-events: none;
-webkit-font-smoothing: subpixel-antialiased;
}
.unicode { font-family: monospace; font-size: 0.5rem; color: #aaa; margin-top: 8px; pointer-events: none; }

/* --- Footer --- */
footer { 
padding: 60px 5%; 
color: #888; 
font-size: 0.75rem; 
border-top: 1px solid var(--border);
display: flex;
justify-content: space-between;
align-items: center;
flex-wrap: wrap;
gap: 20px;
}

footer a { color: var(--text); text-decoration: none; font-weight: 600; }
footer a:hover { text-decoration: underline; }
.footer-left span { margin-right: 15px; }

@media (max-width: 850px) {
.tester-container { flex-direction: column; }
.sidebar { width: 100%; position: static; margin-top: 20px; }
.hero h1 { font-size: 4rem; }
.glyph-item.active { transform: scale(2) translateZ(0); }
footer { flex-direction: column; align-items: flex-start; }
}
</style>
</head>
<body>

<section class="hero">
<h1 id="hero-title">Loading...</h1>
<div class="metadata-grid" id="metaGrid">
<div class="meta-item"><label>Designer</label><span id="metaDesigner">—</span></div>
<div class="meta-item"><label>Version</label><span id="metaVersion">—</span></div>
<div class="meta-item"><label>License</label><span id="metaLicense">—</span></div>
</div>
</section>

<section id="tester">
<h3>Interactive Tester</h3>
<div class="tester-container">
<textarea id="typeTester" spellcheck="false">The quick brown fox jumps over the lazy dog.</textarea>
<div class="sidebar" id="axisControls">
<div class="control-group">
<label>Size <span class="val" id="sizeVal">48px</span></label>
<input type="range" id="sizeSlider" min="12" max="150" value="48">
</div>
<button class="reset-btn" id="resetAxes">Reset to Default</button>
</div>
</div>
</section>

<section id="glyphs">
<div class="glyph-header">
<h3>Glyphs</h3>
</div>
<div class="glyph-grid" id="glyphGrid"></div>
</section>

<footer>
<div class="footer-left">
<span><strong>Type Specimen</strong> v1.0.2</span>
<span>Created by <a href="https://github.com/yourusername" target="_blank">Your Name</a></span>
</div>
<div class="footer-right">
<a href="https://github.com/yourusername/yourproject" target="_blank">View on GitHub</a>
</div>
</footer>

<script>
const FONT_FILENAME = 'Roboto-VariableFont_wdth,wght.ttf';
const FONT_PATH = 'fonts/' + FONT_FILENAME;
const CUSTOM_FAMILY = 'SpecimenFont';

opentype.load(FONT_PATH, function(err, font) {
if (err) {
document.getElementById('hero-title').innerText = "Load Error";
return;
}
setupSpecimen(font);
});

function setupSpecimen(font) {
const style = document.createElement('style');
style.innerHTML = `@font-face { font-family: '${CUSTOM_FAMILY}'; src: url('${FONT_PATH}'); font-weight: 1 1000; }`;
document.head.appendChild(style);

const names = font.names;
document.getElementById('hero-title').innerText = names.typographicFamily?.en || names.fontFamily.en;
document.getElementById('hero-title').style.fontFamily = CUSTOM_FAMILY;
document.getElementById('metaDesigner').innerText = names.designer?.en || "Unknown Designer";
document.getElementById('metaVersion').innerText = names.version?.en || "Version 1.000";
document.getElementById('metaLicense').innerText = names.license?.en || "Standard License";
const tester = document.getElementById('typeTester');
tester.style.fontFamily = CUSTOM_FAMILY;

const grid = document.getElementById('glyphGrid');
grid.innerHTML = '';
let unicodes = [];
if (font.tables.cmap && font.tables.cmap.glyphIndexMap) {
unicodes = Object.keys(font.tables.cmap.glyphIndexMap).map(k => parseInt(k));
}

const displayLimit = Math.min(unicodes.length, 300);
for (let i = 0; i < displayLimit; i++) {
const code = unicodes[i];
const div = document.createElement('div');
div.className = 'glyph-item';
div.style.fontFamily = CUSTOM_FAMILY;

const hexCode = "U+" + code.toString(16).toUpperCase().padStart(4, '0');
div.innerHTML = `<span class="char">${String.fromCodePoint(code)}</span><span class="unicode">${hexCode}</span>`;

div.onclick = function(e) {
const isActive = this.classList.contains('active');
const rect = this.getBoundingClientRect();
const screenWidth = window.innerWidth;
if (rect.left < 80) this.style.transformOrigin = 'left center';
else if (rect.right > screenWidth - 80) this.style.transformOrigin = 'right center';
else this.style.transformOrigin = 'center center';

document.querySelectorAll('.glyph-item').forEach(item => item.classList.remove('active'));
if (!isActive) this.classList.add('active');
if (e && e.stopPropagation) e.stopPropagation();
};
grid.appendChild(div);
}

// Keyboard Navigation
document.addEventListener('keydown', (e) => {
const activeGlyph = document.querySelector('.glyph-item.active');
if (!activeGlyph) return;

if (e.key === 'ArrowRight') {
const next = activeGlyph.nextElementSibling;
if (next) next.click();
} else if (e.key === 'ArrowLeft') {
const prev = activeGlyph.previousElementSibling;
if (prev) prev.click();
} else if (e.key === 'Escape') {
activeGlyph.classList.remove('active');
}
});

document.addEventListener('click', (e) => {
if (!e.target.closest('.glyph-item')) {
document.querySelectorAll('.glyph-item').forEach(item => item.classList.remove('active'));
}
});

const axisControls = document.getElementById('axisControls');
const resetBtn = document.getElementById('resetAxes');
const defaultAxes = {};

if (font.tables.fvar && font.tables.fvar.axes) {
font.tables.fvar.axes.forEach(axis => {
defaultAxes[axis.tag] = axis.defaultValue;
const group = document.createElement('div');
group.className = 'control-group';
group.innerHTML = `
<label>${axis.name.en || axis.tag} <span class="val" id="val-${axis.tag}">${axis.defaultValue}</span></label>
<input type="range" class="axis-slider" data-tag="${axis.tag}" min="${axis.minValue}" max="${axis.maxValue}" value="${axis.defaultValue}">
`;
axisControls.insertBefore(group, resetBtn);
});
}

function applySettings(varString) {
tester.style.fontVariationSettings = varString;
document.querySelectorAll('.char').forEach(c => c.style.fontVariationSettings = varString);
}

function updateFromSliders() {
let settings = [];
document.querySelectorAll('.axis-slider').forEach(s => {
const tag = s.getAttribute('data-tag');
const valDisplay = document.getElementById(`val-${tag}`);
if (valDisplay) valDisplay.innerText = s.value;
settings.push(`"${tag}" ${s.value}`);
});
applySettings(settings.join(', '));
}

resetBtn.addEventListener('click', function() {
document.querySelectorAll('.axis-slider').forEach(slider => {
const tag = slider.getAttribute('data-tag');
slider.value = defaultAxes[tag];
});
const sizeSlider = document.getElementById('sizeSlider');
sizeSlider.value = 48;
tester.style.fontSize = '48px';
document.getElementById('sizeVal').innerText = '48px';
updateFromSliders();
});

document.body.addEventListener('input', function(e) {
if (e.target.classList.contains('axis-slider')) updateFromSliders();
if (e.target.id === 'sizeSlider') {
tester.style.fontSize = e.target.value + 'px';
document.getElementById('sizeVal').innerText = e.target.value + 'px';
}
});

updateFromSliders();
}
</script>
</body>
</html>